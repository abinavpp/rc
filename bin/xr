#! /bin/bash

function show() {
  local op=$1 run=$2 l mode
  if [[ $op == "pri" ]]; then
    l=`xrandr -q | grep ' connected primary'`
    mode=`echo "$l" | awk '{print $4}'`
  else
    l=`xrandr -q | grep -P ' connected (?!primary)'`
    mode=`echo "$l" | awk '{print $3}'`
  fi

  if [[ $run == "res" ]]; then
    echo "$mode" | awk -F+ '{print $1}'
  else
    echo "$l" | awk '{print $1}'
  fi
}

function p0() {
  local pri=`show pri` pri_res=`show pri res`
  local sec=`show sec` sec_res=`show sec res`
  [[ -z $pri || -z $sec ]] && return

  [[ $pri_res != $sec_res ]] && xrandr --output $pri --mode $sec_res
  xrandr --output $sec --auto --same-as $pri
  xrandr --output $sec --set "Broadcast RGB" "Full"
}

for run in "$@"; do
  [[ $run == "p" ]] && show pri
  [[ $run == "s" ]] && show sec
  [[ $run == "p0" ]] && p0
done
